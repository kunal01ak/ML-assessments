import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

def linear_regression(x_train, y_train):
    X = np.column_stack((np.ones(len(x_train)), x_train))
    
    weights = np.linalg.inv(X.T @ X) @ X.T @ y_train
    
    return weights

# Assuming x_train and y_train are the feature and target arrays for training

weights = linear_regression(x_train, y_train)

y_pred = np.column_stack((np.ones(len(x_test)), x_test)) @ weights
